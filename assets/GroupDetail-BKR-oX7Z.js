import{s as ne,u as le,j as oe,v as D,o as s,c,w as n,g as d,r as a,n as ae,a as se,b as t,_ as ue,f as u,h as w,F as G,k as I,t as x,q as re,e as y,i as h,p as ie}from"./index-BZ2zsZ7L.js";import{u as ce}from"./SachetStore-D-9TX8c6.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";const _e={class:"mt-2 members-scroll-container"},ve={class:"text-secondary text-caption"},pe={class:"d-flex justify-center"},me={class:"text-secondary"},fe={class:"text-center pa-8"},xe={class:"d-flex justify-center align-center ga-5"},ye={class:"d-flex justify-center ga-3"},be={__name:"GroupDetail",setup(ke){const L=ae(),R=se(),b=ne(),S=le(),C=ce(),r=d(null),_=d(null),v=d(!1),i=d([]),p=d(""),m=d([]),U=S.user.user_metadata.username,F=S.user.app_metadata.id_profile;oe(async()=>{j()});const j=async()=>{C.sachets.length===0&&await C.loadSachets(),m.value=C.sachets.filter(l=>l.id_teapot===r.value)},T=async()=>{if(!r.value||r.value==="undefined")return;const l=await b.loadGroupById(r.value);l&&(_.value=l)},q=()=>{if(p.value.trim()!==""){const l=p.value.trim();!i.value.includes(l)&&!_.value.members.includes(l)&&i.value.push(l),p.value=""}},z=l=>{i.value=i.value.filter(e=>e!==l)},E=async()=>{const l={id_teapot:r.value,to_add_username:i.value};(await b.inviteMember(l)).error===null&&(v.value=!1)},P=async()=>{(await b.leaveGroup(r.value,F)).error===null&&R.push("/")};return D(m.value,()=>{j()},{immediate:!0}),D(()=>L.params.id,async l=>{if(l&&l!=="undefined"){r.value=l;const e=b.getById(l);e?_.value=e:await T()}},{immediate:!0}),(l,e)=>{const f=a("v-btn"),Y=a("v-divider"),H=a("v-list-item-title"),M=a("v-list-item"),B=a("v-list"),J=a("v-expansion-panel-text"),K=a("v-expansion-panel"),O=a("v-expansion-panels"),$=a("v-card-title"),N=a("v-card-text"),V=a("v-card"),Q=a("v-icon"),W=a("v-text-field"),X=a("v-chip"),Z=a("v-bottom-sheet"),ee=a("v-col"),te=a("v-row"),A=a("v-container");return r.value?(s(),c(A,{key:0},{default:n(()=>[t(ue,{backIcon:"",title:_.value?.name||"Loading..."},null,8,["title"]),t(te,{justify:"center"},{default:n(()=>[t(ee,{cols:"12",md:"7"},{default:n(()=>[t(O,null,{default:n(()=>[t(K,{title:"Members"},{default:n(()=>[t(J,null,{default:n(()=>[t(f,{onClick:e[0]||(e[0]=o=>v.value=!v.value),class:"mb-2",color:"secondary",text:"Invite"}),t(Y,{thickness:"2"}),u("div",_e,[t(B,{class:"pa-0",lines:"one",rounded:"lg"},{default:n(()=>[(s(!0),w(G,null,I(_.value.members,(o,k)=>(s(),c(M,{key:k,class:"pa-0"},{default:n(()=>[t(H,null,{default:n(()=>[u("span",null,x(o),1),u("span",ve,x(re(U)===o?" (You)":""),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1})]),_:1})]),_:1}),u("div",pe,[t(f,{style:{position:"fixed",bottom:"100px"},onClick:P,color:"error",text:"Leave teapot"})]),m.value.length?(s(),c(V,{key:0,class:"mt-5"},{default:n(()=>[t($,null,{default:n(()=>[...e[4]||(e[4]=[y("Sachets",-1)])]),_:1}),t(N,null,{default:n(()=>[t(B,null,{default:n(()=>[(s(!0),w(G,null,I(m.value,(o,k)=>(s(),c(M,{to:`/sachet/${o.id_sachet}`,key:k},{default:n(()=>[y(x(o.date)+" ",1),u("span",me,x(o.leaf?.length>3?o.leaf.slice(0,3).map(g=>g.title).join(", ")+"...":o.leaf?.map(g=>g.title).join(", ")),1)]),_:2},1032,["to"]))),128))]),_:1})]),_:1})]),_:1})):h("",!0),m.value.length?h("",!0):(s(),c(V,{key:1,class:"mt-5"},{default:n(()=>[t($,{class:"pa-10 text-center text-grey"},{default:n(()=>[t(Q,{size:"x-small",icon:"mdi-sleep"}),e[5]||(e[5]=y(" No sachets! ",-1))]),_:1})]),_:1})),u("div",fe,[t(Z,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=o=>v.value=o),inset:""},{default:n(()=>[t(V,{class:"border-lg text-center",height:"200"},{default:n(()=>[t(N,null,{default:n(()=>[e[6]||(e[6]=u("br",null,null,-1)),u("div",xe,[t(W,{label:"username",variant:"outlined",clearable:"","hide-details":"",modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),autocomplete:"off"},null,8,["modelValue"]),t(f,{variant:"outlined",color:"secondary",onClick:q,text:"Add"})]),e[7]||(e[7]=u("br",null,null,-1)),(s(!0),w(G,null,I(i.value,(o,k)=>(s(),c(X,{key:o,class:"ma-2",closable:"","onClick:close":g=>z(o)},{default:n(()=>[y(x(o),1)]),_:2},1032,["onClick:close"]))),128)),e[8]||(e[8]=u("br",null,null,-1)),e[9]||(e[9]=u("br",null,null,-1)),u("div",ye,[i.value.length>0?(s(),c(f,{key:0,variant:"outlined",color:"error",onClick:e[2]||(e[2]=o=>i.value=[]),text:"Remove all"})):h("",!0),i.value.length>0?(s(),c(f,{key:1,color:"primary",onClick:E,text:"Invite"})):h("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1}),t(ie,{leaf:"",sachet:"",teapotId:r.value??"blank"},null,8,["teapotId"])]),_:1})):(s(),c(A,{key:1},{default:n(()=>[...e[10]||(e[10]=[y("Gruppo non trovato!",-1)])]),_:1}))}}},Ve=de(be,[["__scopeId","data-v-e9651199"]]);export{Ve as default};
