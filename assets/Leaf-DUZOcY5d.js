import{j as M,o as i,c as x,w as o,n as H,g as c,r as n,a as J,b as l,_ as K,e as _,t as u,f as d,h,F as C,k as $,i as O}from"./index-BrsjV_O1.js";import{u as P}from"./LeafStore-y32iODN0.js";import{u as Q}from"./SachetStore-CcDLZOjf.js";import{_ as W}from"./vue-helpers-DlAUqK2U.js";const X={class:"text-h4 font-weight-bold mt-4"},Y={class:"text-center"},Z={key:0,class:"position-sticky top-0 bg-surface z-index-2 pa-1 border-bottom"},ee={__name:"Leaf",setup(te){const L=P(),r=Q(),j=H(),g=J(),B=c(!1),p=c(""),f=c(""),v=c(!1),a=c([]),k=c([]),m=j.query.sachetId;M(async()=>{if(r.sachets.length===0&&await r.loadSachets(),k.value=r.sachets,m){const s=await r.getSachetById(m);a.value.push(s.data[0])}});const I=s=>{a.value.includes(s)||a.value.push(s)},N=s=>{a.value=a.value.filter(t=>t!==s)},R=async()=>{const s={title:p.value,description:f.value},t=await L.createLeaf(s);if(t.error==null){if(a.value.length>0&&(await r.addSachetsToLeaf(t.data[0],a.value)).error===null&&m){g.push(`/sachet/${m}`);return}g.push("/")}};return(s,t)=>{const y=n("v-icon"),S=n("v-text-field"),b=n("v-card"),V=n("v-card-text"),w=n("v-btn"),T=n("v-card-actions"),U=n("v-form"),q=n("v-chip"),z=n("v-list-item-title"),D=n("v-list-item"),F=n("v-list"),A=n("v-bottom-sheet"),E=n("v-container");return i(),x(E,{fluid:"",class:"fill-height d-flex justify-center align-center"},{default:o(()=>[l(K,{backIcon:"",title:"Go back"}),l(b,{class:"d-flex flex-column align-center w-100","max-width":"450"},{title:o(()=>[d("span",X,[l(y,{icon:"mdi-leaf",size:"xs"}),t[5]||(t[5]=_(" New Leaf ",-1))])]),default:o(()=>[l(U,{ref:"form",class:"w-100"},{default:o(()=>[l(V,null,{default:o(()=>[l(S,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),label:"Title",variant:"outlined",clearable:"",rules:[e=>!!e||"Required"]},null,8,["modelValue","rules"]),l(S,{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=e=>f.value=e),label:"Description",variant:"outlined",clearable:""},null,8,["modelValue"]),l(b,{variant:"tonal",title:"Add to sachet","append-icon":"mdi-chevron-right",onClick:t[2]||(t[2]=e=>v.value=!v.value)},{subtitle:o(()=>[_(u(a.value.length>5?a.value.slice(0,5).map(e=>`${e.date} (${e.teapot.name})`).join(", ")+"...":a.value.map(e=>`${e.date} (${e.teapot.name})`).join(", ")),1)]),_:1})]),_:1}),l(T,{class:"justify-end w-100"},{default:o(()=>[l(w,{onClick:R,variant:"tonal",color:"secondary",disabled:B.value,text:"Create","prepend-icon":"mdi-leaf"},null,8,["disabled"])]),_:1})]),_:1},512)]),_:1}),d("div",Y,[l(A,{modelValue:v.value,"onUpdate:modelValue":t[4]||(t[4]=e=>v.value=e),inset:""},{default:o(()=>[l(b,{class:"border-lg text-center","min-height":"200","max-height":"600"},{default:o(()=>[l(V,null,{default:o(()=>[a.value.length>0?(i(),h("div",Z,[l(w,{variant:"outlined",color:"error",onClick:t[3]||(t[3]=e=>a.value=[]),text:"Remove all"}),t[6]||(t[6]=d("br",null,null,-1)),(i(!0),h(C,null,$(a.value,(e,G)=>(i(),x(q,{key:e,class:"ma-2",closable:"","onClick:close":le=>N(e)},{default:o(()=>[_(u(e.date)+" ("+u(e.teapot.name)+")",1)]),_:2},1032,["onClick:close"]))),128))])):O("",!0),t[7]||(t[7]=d("br",null,null,-1)),l(F,null,{default:o(()=>[(i(!0),h(C,null,$(k.value,e=>(i(),x(D,{key:e,disabled:a.value.includes(e),onClick:G=>I(e),"prepend-icon":a.value.includes(e)?"mdi-check":"mdi-plus"},{default:o(()=>[l(z,null,{default:o(()=>[_(u(e.date)+" ("+u(e.teapot.name)+")",1)]),_:2},1024)]),_:2},1032,["disabled","onClick","prepend-icon"]))),128))]),_:1}),t[8]||(t[8]=d("br",null,null,-1))]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})}}},ie=W(ee,[["__scopeId","data-v-0336cd15"]]);export{ie as default};
