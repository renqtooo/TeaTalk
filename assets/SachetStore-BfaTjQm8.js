import{x as n,y as c}from"./index-BamXPezn.js";const l=n("sachetStore",{state:()=>({sachets:[]}),actions:{async loadSachets(){const e=await c.from("sachet").select("*, leaf (id_leaf, title), teapot (name)");return e.error===null&&(this.sachets=e.data),e},async getSachetById(e){return await c.from("sachet").select("*, leaf (id_leaf, title), teapot (name)").eq("id_sachet",e)},async createSachet(e){const s=await c.from("sachet").insert(e).select("*, leaf (id_leaf, title), teapot (name)");return s.error===null&&this.sachets.push(s.data[0]),s},async addLeafsToSachet(e,s){const i=s.map(t=>({id_sachet:e,id_leaf:t.id_leaf})),a=await c.from("leaf_sachet").insert(i);if(a.error===null){const t=this.sachets.findIndex(r=>r.id_sachet===e);t!==-1&&(this.sachets[t].leaf||(this.sachets[t].leaf=[]),this.sachets[t].leaf.push(...s))}return a},async addSachetsToLeaf(e,s){const i=s.map(t=>({id_leaf:e.id_leaf,id_sachet:t.id_sachet})),a=await c.from("leaf_sachet").insert(i).select().single();return a.error===null&&s.forEach(t=>{const r=this.sachets.findIndex(h=>h.id_sachet==t.id_sachet);this.sachets[r].leaf||(this.sachets[r].leaf=[]),this.sachets[r].leaf.push(e)}),a},async removeLeafFromSachet(e,s){const i=await c.from("leaf_sachet").delete().eq("id_sachet",e).eq("id_leaf",s),a=this.sachets.findIndex(t=>t.id_sachet==e);return this.sachets[a].leaf=this.sachets[a].leaf.filter(t=>t.id_leaf!==s),i}}});export{l as u};
