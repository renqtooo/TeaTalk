import{j as G,o as i,c as p,w as o,n as M,g as c,r as a,a as H,b as l,_ as J,e as v,t as f,f as u,h as b,F as y,k as w,i as K,m as O}from"./index-Dis5WrDB.js";import{u as P}from"./LeafStore-z2ydBMHc.js";import{u as Q}from"./SachetStore-Cs2zW5pg.js";const W={class:"text-h4 font-weight-bold mt-4"},X={class:"text-center"},Y={key:0,class:"position-sticky top-0 bg-surface z-index-1 pa-1 border-bottom"},oe={__name:"Sachet",setup(Z){const d=P(),x=Q(),C=M(),V=H(),h=c(null),_=c(null),S=c(!1),r=c(!1),n=c([]),L=O(()=>d.leafs);G(async()=>{(!d.leafs||d.leafs.length===0)&&await d.loadLeafs(),h.value=C.query.teapotId});const j=s=>{n.value.includes(s)||n.value.push(s)},N=s=>{n.value=n.value.filter(e=>e!==s)},$=async()=>{const s={id_teapot:h.value,date:_.value},e=await x.createSachet(s);e.error===null&&(n.value&&await x.addLeafsToSachet(e.data[0].id_sachet,n.value),V.back())};return(s,e)=>{const B=a("v-icon"),R=a("v-text-field"),m=a("v-card"),k=a("v-card-text"),g=a("v-btn"),I=a("v-card-actions"),q=a("v-form"),z=a("v-chip"),D=a("v-list-item-title"),F=a("v-list-item"),T=a("v-list"),U=a("v-bottom-sheet"),A=a("v-container");return i(),p(A,{fluid:"",class:"fill-height d-flex justify-center align-center"},{default:o(()=>[l(J,{backIcon:"",title:"Go back"}),l(m,{class:"d-flex flex-column align-center w-100","max-width":"450"},{title:o(()=>[u("span",W,[l(B,{icon:"mdi-tea",size:"xs"}),e[4]||(e[4]=v(" New Sachet",-1))])]),default:o(()=>[l(q,{ref:"form",class:"w-100"},{default:o(()=>[l(k,null,{default:o(()=>[l(R,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t),label:"Date",variant:"outlined",type:"date",rules:[t=>!!t||"Required"]},null,8,["modelValue","rules"]),l(m,{variant:"tonal",title:"Add leafs","prepend-icon":"mdi-leaf","append-icon":"mdi-chevron-right",onClick:e[1]||(e[1]=t=>r.value=!r.value)},{subtitle:o(()=>[v(f(n.value.length>5?n.value.slice(0,5).map(t=>t.title).join(", ")+"...":n.value.map(t=>t.title).join(", ")),1)]),_:1})]),_:1}),l(I,{class:"justify-end w-100"},{default:o(()=>[l(g,{onClick:$,variant:"tonal",color:"secondary",disabled:S.value,text:"Create","prepend-icon":"mdi-tea"},null,8,["disabled"])]),_:1})]),_:1},512)]),_:1}),u("div",X,[l(U,{modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=t=>r.value=t),inset:""},{default:o(()=>[l(m,{class:"border-lg text-center","min-height":"200","max-height":"600"},{default:o(()=>[l(k,null,{default:o(()=>[n.value.length>0?(i(),b("div",Y,[l(g,{variant:"outlined",color:"error",onClick:e[2]||(e[2]=t=>n.value=[]),text:"Remove all"}),e[5]||(e[5]=u("br",null,null,-1)),(i(!0),b(y,null,w(n.value,(t,E)=>(i(),p(z,{key:t,class:"ma-2",closable:"","onClick:close":ee=>N(t)},{default:o(()=>[v(f(t.title),1)]),_:2},1032,["onClick:close"]))),128))])):K("",!0),e[6]||(e[6]=u("br",null,null,-1)),l(T,null,{default:o(()=>[(i(!0),b(y,null,w(L.value,t=>(i(),p(F,{key:t,disabled:n.value.includes(t),onClick:E=>j(t),"prepend-icon":n.value.includes(t)?"mdi-check":"mdi-plus"},{default:o(()=>[l(D,null,{default:o(()=>[v(f(t.title),1)]),_:2},1024)]),_:2},1032,["disabled","onClick","prepend-icon"]))),128))]),_:1}),e[7]||(e[7]=u("br",null,null,-1))]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})}}};export{oe as default};
